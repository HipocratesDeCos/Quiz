<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SuperQuiz</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: linear-gradient(135deg, #4a90e2, #8e44ad); color: #333; text-align: center; }
    .container { max-width: 900px; margin: 50px auto; background: #fff; padding: 24px; border-radius: 14px; box-shadow: 0 8px 24px rgba(0,0,0,.15); }
    h1 { color: #4a90e2; margin: 0 0 18px; }
    h2 { color: #444; margin-top: 8px; }
    .btn { display: block; width: 85%; margin: 12px auto; padding: 14px; font-size: 18px; color: #fff; background: linear-gradient(90deg, #4a90e2, #8e44ad); border: none; border-radius: 10px; cursor: pointer; transition: transform .15s, box-shadow .15s; box-shadow: 0 6px 12px rgba(78, 4, 114, .18); }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 10px 18px rgba(78, 4, 114, .25); }
    .question { margin: 22px 0 10px; font-weight: 700; text-align: left; }
    .options label { display: block; margin: 8px 0; padding: 10px; border: 1px solid #e4e4e4; border-radius: 8px; cursor: pointer; text-align: left; transition: background-color 0.2s; }
    .options label:hover { background-color: #f0f8ff; }
    .correct { background-color: #c8f7c5 !important; border-color: #4caf50; }
    .incorrect { background-color: #f7c5c5 !important; border-color: #f44336; }
    .saber-mas { display: inline-block; margin: 10px 0 16px; color: #4a90e2; cursor: pointer; text-decoration: underline; }
    .extra { display: none; margin-top: 8px; padding: 12px; background: #f7f7f9; border-radius: 8px; text-align: left; border: 1px dashed #cfd3d8; line-height: 1.6; }
    .score { margin-top: 20px; font-size: 18px; font-weight: 700; }
    .notice { background: #fff7e6; border: 1px solid #ffd591; padding: 14px; border-radius: 10px; color: #8a5a00; margin: 16px 0; text-align: left; }
    .muted { color: #666; font-size: 14px; }
  </style>
</head>
<body>
  <div class="container" id="app">
    <h1>SuperQuiz</h1>
    <div id="menu-principal">
      <button class="btn" onclick="cargarMateria('Contabilidad Financiera')">📘 Contabilidad Financiera</button>
      <button class="btn" onclick="mensajeProximamente('Análisis Económico-Financiero')">📊 Análisis Económico-Financiero</button>
      <button class="btn" onclick="mensajeProximamente('Economía')">💹 Economía</button>
      <button class="btn" onclick="mensajeProximamente('Marketing')">📢 Marketing</button>
    </div>
    <div id="contenido"></div>
  </div>

  <script>
    // Base de datos completa embebida
    const quizDatabase = {
      'contabilidad-basica': {
        "nombre": "Contabilidad básica",
        "temas": [
          {
            "nombre": "Introducción al PGC y Marco Conceptual",
            "introduccion": "El Plan General de Contabilidad (PGC) es el marco normativo que regula la contabilidad en España, estableciendo principios, normas de registro y valoración para garantizar información financiera homogénea y fiable.",
            "preguntas": [
              {
                "texto": "¿Cuáles son los objetivos principales del Plan General de Contabilidad?",
                "opciones": [
                  "Homogeneizar la información contable entre empresas",
                  "Garantizar la utilidad de la información para la toma de decisiones económicas",
                  "Establecer criterios fiscales para el cálculo de impuestos",
                  "Facilitar la comparabilidad de la información financiera"
                ],
                "correctas": [0, 1, 3],
                "explicacion": "<p>El <u>objetivo principal del PGC</u> es proporcionar un marco normativo común que permita la elaboración de estados financieros <u>homogéneos, comprensibles y comparables</u> entre diferentes empresas. Este objetivo es clave para que los usuarios, como inversores, acreedores o analistas, puedan tomar decisiones económicas fundamentadas.</p><p>La <u>homogeneidad</u> permite comparar la situación financiera de empresas del mismo sector, mientras que la <u>utilidad</u> se logra mediante la adecuada presentación y valoración de los elementos patrimoniales.</p>"
              },
              {
                "texto": "¿Cuál es la función principal del Marco Conceptual de la Contabilidad?",
                "opciones": [
                  "Servir como guía para la elaboración de impuestos",
                  "Explicar el porqué de los tratamientos contables y sustentar la imagen fiel",
                  "Reemplazar las normas de registro y valoración",
                  "Facilitar la auditoría interna de las pymes"
                ],
                "correctas": [1],
                "explicacion": "<p>El <u>Marco Conceptual</u> es la estructura teórica que sustenta todo el armazón contable, actuando como una <u>Ley fundamental o Constitución contable</u>. Su función principal es explicar el porqué de los tratamientos de registro y valoración adoptados por el PGC.</p>"
              },
              {
                "texto": "¿Cuáles de los siguientes son principios contables establecidos por el PGC?",
                "opciones": [
                  "Empresa en funcionamiento",
                  "Devengo",
                  "Prudencia",
                  "Compensación entre partidas"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El PGC establece seis <u>principios contables</u> obligatorios: <u>empresa en funcionamiento</u>, <u>devengo</u>, <u>uniformidad</u>, <u>prudencia</u>, <u>no compensación</u> e <u>importancia relativa</u>. El principio de compensación no existe; es precisamente lo contrario: <u>no compensación</u>.</p>"
              },
              {
                "texto": "¿Qué establece el principio del devengo?",
                "opciones": [
                  "Registrar ingresos y gastos cuando se cobran o pagan",
                  "Registrar ingresos y gastos cuando se generan, independientemente del cobro o pago",
                  "Distribuir los gastos uniformemente entre ejercicios",
                  "Solo registrar operaciones con efectivo"
                ],
                "correctas": [1],
                "explicacion": "<p>El <u>principio del devengo</u> establece que los ingresos y gastos deben reconocerse en el período en que se generan, <u>independientemente de cuándo se cobren o paguen</u>. Por ejemplo, si una empresa presta un servicio en diciembre pero cobra en enero, el ingreso se registra en diciembre.</p>"
              }
            ]
          }
        ]
      },
      
      'inversion-no-corriente': {
        "nombre": "Inversión no corriente",
        "temas": [
          {
            "nombre": "Inmovilizado Material",
            "introduccion": "El inmovilizado material comprende elementos tangibles con vida útil superior a un año, destinados al uso en la actividad empresarial.",
            "preguntas": [
              {
                "texto": "¿Cuál es el criterio de valoración inicial del inmovilizado material?",
                "opciones": [
                  "Precio de adquisición más gastos necesarios hasta su puesta en funcionamiento",
                  "Valor de mercado en la fecha de compra",
                  "Valor nominal del bien",
                  "Precio de venta esperado"
                ],
                "correctas": [0],
                "explicacion": "<p>El inmovilizado material se valora inicialmente por su <u>precio de adquisición</u> más todos los <u>gastos necesarios</u> hasta su puesta en funcionamiento: transporte, instalación, seguros, aranceles, honorarios profesionales, etc.</p>"
              },
              {
                "texto": "¿Qué elementos se incluyen en el inmovilizado material?",
                "opciones": [
                  "Terrenos y construcciones",
                  "Maquinaria y equipos para procesos productivos",
                  "Mobiliario y enseres",
                  "Patentes y marcas"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El inmovilizado material incluye elementos <u>tangibles</u> como terrenos, construcciones, maquinaria, equipos, mobiliario, vehículos, etc. Las patentes y marcas son <u>inmovilizado intangible</u>, no material.</p>"
              }
            ]
          },
          {
            "nombre": "Inmovilizado Intangible",
            "introduccion": "Constituido por bienes inmateriales y derechos susceptibles de valoración económica que cumplen las características de permanencia y utilización en la actividad empresarial.",
            "preguntas": [
              {
                "texto": "¿Cuáles son ejemplos de inmovilizado intangible?",
                "opciones": [
                  "Patentes y marcas comerciales",
                  "Aplicaciones informáticas (software)",
                  "Derechos de traspaso",
                  "Maquinaria industrial"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El inmovilizado intangible incluye elementos <u>inmateriales</u>: patentes, marcas, licencias, aplicaciones informáticas, derechos de traspaso, concesiones administrativas, etc. La maquinaria industrial es <u>inmovilizado material</u>.</p>"
              }
            ]
          }
        ]
      },
      
      'inversion-corriente': {
        "nombre": "Inversión corriente",
        "temas": [
          {
            "nombre": "Existencias",
            "introduccion": "Las existencias son bienes poseídos para ser vendidos en el curso normal de la explotación, en proceso de producción o en forma de materiales o suministros para ser consumidos en el proceso productivo.",
            "preguntas": [
              {
                "texto": "¿Qué tipos de existencias reconoce el PGC?",
                "opciones": [
                  "Materias primas y otros aprovisionamientos",
                  "Productos en curso y semiterminados",
                  "Productos terminados",
                  "Inmovilizado en curso"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El PGC reconoce varios tipos de existencias: <u>materias primas</u>, <u>productos en curso</u>, <u>productos semiterminados</u>, <u>productos terminados</u>, <u>subproductos y residuos</u>, y <u>mercaderías</u>. El inmovilizado en curso no es una existencia.</p>"
              }
            ]
          },
          {
            "nombre": "Realizable",
            "introduccion": "Comprende los derechos de cobro y otros activos líquidos que se espera convertir en efectivo en el corto plazo.",
            "preguntas": [
              {
                "texto": "¿Qué elementos forman parte del realizable?",
                "opciones": [
                  "Clientes por ventas pendientes de cobro",
                  "Deudores diversos",
                  "Créditos concedidos a empleados",
                  "Terrenos para la venta"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El realizable incluye <u>derechos de cobro</u>: clientes, deudores, préstamos concedidos, créditos al personal, etc. Los terrenos son <u>inmovilizado material</u>, aunque estén destinados a la venta.</p>"
              }
            ]
          }
        ]
      },
      
      'patrimonio-neto': {
        "nombre": "Patrimonio neto",
        "temas": [
          {
            "nombre": "Capital Social y Reservas",
            "introduccion": "El patrimonio neto representa la parte residual de los activos una vez deducidos todos los pasivos. Incluye las aportaciones de socios y los beneficios generados y no distribuidos.",
            "preguntas": [
              {
                "texto": "¿Qué componentes forman el patrimonio neto?",
                "opciones": [
                  "Capital social suscrito",
                  "Reservas legales y voluntarias",
                  "Resultado del ejercicio",
                  "Préstamos bancarios a largo plazo"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>El patrimonio neto incluye: <u>capital social</u>, <u>reservas</u> (legal, voluntaria, etc.), <u>resultado del ejercicio</u>, <u>subvenciones</u>, etc. Los préstamos bancarios son <u>pasivos</u>, no patrimonio neto.</p>"
              }
            ]
          }
        ]
      },
      
      'pasivo-corriente-y-no-corriente': {
        "nombre": "Pasivo corriente y no corriente",
        "temas": [
          {
            "nombre": "Clasificación del Pasivo",
            "introduccion": "El pasivo se clasifica en corriente (vencimiento inferior a un año) y no corriente (vencimiento superior a un año), según el plazo de exigibilidad.",
            "preguntas": [
              {
                "texto": "¿Qué caracteriza al pasivo corriente?",
                "opciones": [
                  "Vencimiento inferior a un año",
                  "Se espera liquidar en el ciclo normal de explotación",
                  "Son deudas a largo plazo",
                  "Incluye las provisiones a corto plazo"
                ],
                "correctas": [0, 1, 3],
                "explicacion": "<p>El <u>pasivo corriente</u> incluye obligaciones con vencimiento <u>inferior a un año</u> o que se liquidarán en el <u>ciclo normal de explotación</u>: proveedores, acreedores, préstamos a corto plazo, provisiones a corto plazo, etc.</p>"
              }
            ]
          }
        ]
      },
      
      'impuesto-de-sociedades': {
        "nombre": "Impuesto de Sociedades",
        "temas": [
          {
            "nombre": "Diferencias Temporarias",
            "introduccion": "Las diferencias entre el resultado contable y la base imponible fiscal pueden originar activos y pasivos por impuestos diferidos.",
            "preguntas": [
              {
                "texto": "¿Qué son las diferencias temporarias?",
                "opciones": [
                  "Diferencias entre el valor contable y fiscal de activos y pasivos",
                  "Diferencias que se revierten en ejercicios futuros",
                  "Diferencias permanentes entre contabilidad y fiscalidad",
                  "Diferencias que originan impuestos diferidos"
                ],
                "correctas": [0, 1, 3],
                "explicacion": "<p>Las <u>diferencias temporarias</u> son diferencias entre el valor contable y fiscal de activos/pasivos que se <u>revierten en el futuro</u>, originando <u>impuestos diferidos</u>. Las diferencias permanentes no son temporarias.</p>"
              }
            ]
          }
        ]
      },
      
      'cuentas-anuales': {
        "nombre": "Cuentas anuales",
        "temas": [
          {
            "nombre": "Estructura de las Cuentas Anuales",
            "introduccion": "Las cuentas anuales comprenden el balance, la cuenta de pérdidas y ganancias, el estado de cambios en el patrimonio neto, el estado de flujos de efectivo y la memoria.",
            "preguntas": [
              {
                "texto": "¿Qué documentos forman las cuentas anuales completas?",
                "opciones": [
                  "Balance de situación",
                  "Cuenta de pérdidas y ganancias",
                  "Estado de flujos de efectivo",
                  "Declaración fiscal del ejercicio"
                ],
                "correctas": [0, 1, 2],
                "explicacion": "<p>Las cuentas anuales incluyen: <u>balance</u>, <u>cuenta de pérdidas y ganancias</u>, <u>estado de cambios en el patrimonio neto</u>, <u>estado de flujos de efectivo</u> y <u>memoria</u>. La declaración fiscal no forma parte de las cuentas anuales.</p>"
              }
            ]
          }
        ]
      }
    };

    // --- Estado global
    let datos;
    let aciertos = 0; let fallos = 0;
    let estado = { materia: null, quiz: null };

    function slugify(str){
      return str
        .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
        .toLowerCase()
        .replace(/&/g,'-y-')
        .replace(/[^a-z0-9]+/g,'-')
        .replace(/(^-|-$)/g,'');
    }

    function cargarQuiz(nombreQuiz){
      estado.quiz = nombreQuiz;
      const slug = slugify(nombreQuiz);
      
      if (quizDatabase[slug]) {
        datos = quizDatabase[slug];
        mostrarTemas(datos.temas, `${estado.materia} · ${nombreQuiz}`);
      } else {
        mostrarErrorQuizNoEncontrado(nombreQuiz);
      }
    }

    function mostrarErrorQuizNoEncontrado(nombreQuiz) {
      const cont = document.getElementById('contenido');
      cont.innerHTML = `
        <h2>⚠️ Quiz no encontrado</h2>
        <div class="notice">
          El quiz "<strong>${nombreQuiz}</strong>" aún no está disponible en esta versión.
          <br><br>
          <strong>Disponibles:</strong> ${Object.keys(quizDatabase).join(', ')}
        </div>
        <button class='btn' onclick="cargarMateria('Contabilidad Financiera')">🔙 Volver a Contabilidad Financiera</button>
        <button class='btn' onclick="volverMenu()">🏠 Volver al menú principal</button>
      `;
    }

    function cargarMateria(nombreMateria){
      estado.materia = nombreMateria;
      document.getElementById('menu-principal').style.display = 'none';
      const cont = document.getElementById('contenido');

      if (nombreMateria === 'Contabilidad Financiera') {
        cont.innerHTML = `<h2>${nombreMateria}</h2>`;
        const quizzes = [
          'Contabilidad básica',
          'Inversión no corriente',
          'Inversión corriente',
          'Patrimonio neto',
          'Pasivo corriente y no corriente',
          'Impuesto de Sociedades',
          'Cuentas anuales'
        ];
        quizzes.forEach(q => {
          const slug = slugify(q);
          const disponible = quizDatabase[slug] ? '✅' : '⏳';
          cont.innerHTML += `<button class='btn' onclick="cargarQuiz('${q}')">${disponible} ${q}</button>`;
        });
        cont.innerHTML += `<button class='btn' onclick="volverMenu()">🏠 Volver al menú principal</button>`;
      } else {
        cont.innerHTML = `<div class='notice'>La materia <b>${nombreMateria}</b> estará disponible próximamente.</div>`;
        cont.innerHTML += `<button class='btn' onclick="volverMenu()">🏠 Volver al menú principal</button>`;
      }
    }

    function mostrarTemas(temas, titulo){
      const cont = document.getElementById('contenido');
      cont.innerHTML = `<h2>${titulo}</h2>`;
      temas.forEach((tema, index) => {
        cont.innerHTML += `<button class='btn' onclick="mostrarQuiz(${index})">${tema.nombre}</button>`;
      });
      cont.innerHTML += `<button class='btn' onclick="cargarMateria('Contabilidad Financiera')">🔙 Volver a quizzes de Contabilidad</button>`;
      cont.innerHTML += `<button class='btn' onclick="volverMenu()">🏠 Volver al menú principal</button>`;
    }

    function mostrarQuiz(indexTema){
      const tema = datos.temas[indexTema];
      const cont = document.getElementById('contenido');
      aciertos = 0; fallos = 0;
      let html = `<h2>${tema.nombre}</h2><p class='muted'>${tema.introduccion || ''}</p>`;
      tema.preguntas.forEach((pregunta, i) => {
        html += `<div class='question'>${pregunta.texto}</div>`;
        html += `<div class='options'>`;
        pregunta.opciones.forEach((op, j) => {
          html += `<label><input type='checkbox' name='p${i}' value='${j}' onchange='resetValidation(${i})'> ${op}</label>`;
        });
        html += `</div>`;
        html += `<button class='btn' onclick='validar(${i}, ${JSON.stringify(pregunta.correctas)})'>Validar</button>`;
        html += `<span class='saber-mas' onclick="toggleExtra('extra${i}')">Saber más</span>`;
        html += `<div class='extra' id='extra${i}'>${pregunta.explicacion || ''}</div>`;
      });
      html += `<div class='score' id='resultado'></div>`;
      html += `<button class='btn' onclick="mostrarTemas(datos.temas, '${estado.materia} · ${estado.quiz}')">🔙 Volver a temas</button>`;
      html += `<button class='btn' onclick="cargarMateria('Contabilidad Financiera')">📚 Ver otros quizzes</button>`;
      html += `<button class='btn' onclick="volverMenu()">🏠 Menú principal</button>`;
      cont.innerHTML = html;
    }

    function resetValidation(numPregunta) {
      const opciones = document.getElementsByName(`p${numPregunta}`);
      opciones.forEach(op => {
        op.parentElement.classList.remove('correct', 'incorrect');
      });
    }

    function validar(numPregunta, correctas){
      const opciones = document.getElementsByName(`p${numPregunta}`);
      let seleccionadas = [];
      opciones.forEach((op, i) => { if (op.checked) seleccionadas.push(i); });
      const esCorrecta = JSON.stringify(seleccionadas.sort()) === JSON.stringify([...(correctas||[])].sort());
      
      if (esCorrecta) {
        aciertos++; 
        opciones.forEach(op => op.parentElement.classList.add('correct'));
      } else {
        fallos++; 
        opciones.forEach(op => op.parentElement.classList.add('incorrect'));
      }
      document.getElementById('resultado').innerHTML = `✅ Aciertos: ${aciertos} | ❌ Fallos: ${fallos}`;
    }

    function toggleExtra(id){
      const el = document.getElementById(id);
      el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }

    function volverMenu(){
      document.getElementById('contenido').innerHTML = '';
      document.getElementById('menu-principal').style.display = 'block';
      estado = { materia: null, quiz: null };
    }

    function mensajeProximamente(nombre){
      document.getElementById('menu-principal').style.display = 'none';
      const cont = document.getElementById('contenido');
      cont.innerHTML = `<h2>${nombre}</h2><div class='notice'>Esta materia se activará en breve. Mientras tanto, puedes explorar <b>Contabilidad Financiera</b>.</div>`;
      cont.innerHTML += `<button class='btn' onclick="volverMenu()">🏠 Volver al menú principal</button>`;
    }
  </script>
</body>
</html>
